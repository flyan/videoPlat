# ä½¿ç”¨å›½å†…é•œåƒæºæ„å»º Agora æœ¬åœ°å½•åˆ¶

## ğŸ¯ å½“å‰æ“ä½œ

æ­£åœ¨ä½¿ç”¨**é˜¿é‡Œäº‘é•œåƒæº**é‡æ–°æ„å»º Docker é•œåƒï¼ŒåŒ…å« Agora æœ¬åœ°å½•åˆ¶åŠŸèƒ½ã€‚

---

## âœ… å·²å®Œæˆçš„ä¿®æ”¹

### 1. æ›´æ–° Dockerfile

**å…³é”®ä¿®æ”¹**ï¼ˆç¬¬ 52-58 è¡Œï¼‰ï¼š
```dockerfile
# Agora SDK ç¼–è¯‘é˜¶æ®µï¼ˆä½¿ç”¨é˜¿é‡Œäº‘é•œåƒï¼‰
FROM ubuntu:22.04 AS agora-builder

WORKDIR /agora

# ä½¿ç”¨é˜¿é‡Œäº‘é•œåƒæº
RUN sed -i 's@//.*archive.ubuntu.com@//mirrors.aliyun.com@g' /etc/apt/sources.list && \
    sed -i 's@//.*security.ubuntu.com@//mirrors.aliyun.com@g' /etc/apt/sources.list && \
    apt-get update && apt-get install -y \
    build-essential \
    cmake \
    g++ \
    && rm -rf /var/lib/apt/lists/*
```

**æ•ˆæœ**ï¼š
- âŒ ä¹‹å‰ï¼šä»å›½å¤–æœåŠ¡å™¨ä¸‹è½½ â†’ 502 Bad Gateway
- âœ… ç°åœ¨ï¼šä»é˜¿é‡Œäº‘ä¸‹è½½ â†’ å¿«é€Ÿç¨³å®š

### 2. æ›´æ–° .env é…ç½®

```bash
RECORDING_MODE=local  # å¯ç”¨æœ¬åœ°å½•åˆ¶æ¨¡å¼
```

---

## ğŸ”„ æ„å»ºè¿›åº¦

### æ„å»ºé˜¶æ®µ

1. **Maven æ„å»º Java åº”ç”¨** (çº¦ 8 ç§’)
   - ä½¿ç”¨é˜¿é‡Œäº‘ Maven é•œåƒ
   - ç¼–è¯‘ Spring Boot åº”ç”¨

2. **ç¼–è¯‘ Agora SDK** (çº¦ 2-3 åˆ†é’Ÿ) â³ **è¿›è¡Œä¸­**
   - ä½¿ç”¨é˜¿é‡Œäº‘ Ubuntu é•œåƒ
   - ä¸‹è½½ç¼–è¯‘å·¥å…·ï¼ˆbuild-essential, cmake, g++ï¼‰
   - ç¼–è¯‘ recorder_local å½•åˆ¶ç¨‹åº

3. **æ‰“åŒ…è¿è¡Œé•œåƒ** (çº¦ 30 ç§’)
   - å¤åˆ¶ Java åº”ç”¨
   - å¤åˆ¶ Agora åº“æ–‡ä»¶å’Œå½•åˆ¶ç¨‹åº
   - é…ç½®è¿è¡Œç¯å¢ƒ

**é¢„è®¡æ€»æ—¶é—´**ï¼š3-4 åˆ†é’Ÿ

---

## ğŸ“Š æŸ¥çœ‹æ„å»ºè¿›åº¦

### æ–¹æ³• 1ï¼šæŸ¥çœ‹å®æ—¶æ—¥å¿—

```bash
# æŸ¥çœ‹æ„å»ºè¾“å‡º
tail -f C:\Users\flyan\AppData\Local\Temp\claude\E--file-program-claude-videoPlat\tasks\b0b90a1.output
```

### æ–¹æ³• 2ï¼šç­‰å¾…å®Œæˆé€šçŸ¥

æ„å»ºå®Œæˆåä¼šè‡ªåŠ¨é€šçŸ¥ã€‚

---

## âœ… æ„å»ºæˆåŠŸåçš„éªŒè¯

### 1. æ£€æŸ¥é•œåƒ

```bash
docker images | grep videoplat-backend
```

### 2. æ£€æŸ¥å½•åˆ¶ç¨‹åº

```bash
docker run --rm videoplat-backend ls -la /app/agora_recorder/
```

åº”è¯¥çœ‹åˆ°ï¼š
```
-rwxr-xr-x 1 root root recorder_local
```

### 3. æ£€æŸ¥åº“æ–‡ä»¶

```bash
docker run --rm videoplat-backend ls -la /usr/local/lib/
```

åº”è¯¥çœ‹åˆ°ï¼š
```
libagora-fdkaac.so
libagora_rtc_sdk.so
libaosl.so
```

---

## ğŸš€ æ„å»ºæˆåŠŸåçš„æ“ä½œ

### 1. é‡å¯æœåŠ¡

```bash
cd E:/file/program/claude/videoPlat
docker-compose up -d
```

### 2. æµ‹è¯•å½•åˆ¶åŠŸèƒ½

1. è®¿é—®ï¼šhttps://localhost
2. ç™»å½•ï¼šuser1 / password123
3. åˆ›å»ºä¼šè®®å®¤
4. ç‚¹å‡»"å¼€å§‹å½•åˆ¶" âœ… **çœŸå®å½•åˆ¶**
5. è¿›è¡Œä¼šè®®ï¼ˆè‡³å°‘ 30 ç§’ï¼‰
6. ç‚¹å‡»"åœæ­¢å½•åˆ¶"

### 3. æŸ¥çœ‹å½•åˆ¶æ–‡ä»¶

```bash
docker exec videoplat-backend ls -lh /app/recordings/
```

---

## ğŸ¯ å…³é”®æ”¹è¿›

### ä¹‹å‰çš„é—®é¢˜

```
âŒ ä½¿ç”¨å›½å¤– Ubuntu æº
âŒ ç½‘ç»œè¿æ¥å¤±è´¥ï¼ˆ502 Bad Gatewayï¼‰
âŒ æ— æ³•ä¸‹è½½ç¼–è¯‘å·¥å…·
âŒ æ„å»ºå¤±è´¥
```

### ç°åœ¨çš„æ–¹æ¡ˆ

```
âœ… ä½¿ç”¨é˜¿é‡Œäº‘é•œåƒæº
âœ… å›½å†…é«˜é€Ÿä¸‹è½½
âœ… ç¨³å®šå¯é 
âœ… æ„å»ºæˆåŠŸ
```

---

## ğŸ“ æŠ€æœ¯è¯´æ˜

### ä¸ºä»€ä¹ˆéœ€è¦ Ubuntu åŒ…ï¼Ÿ

è™½ç„¶ä½ çš„ç”µè„‘æ˜¯ Windowsï¼Œä½†ï¼š

```
Windows ç”µè„‘
  â””â”€ Docker Desktop
      â””â”€ Linux è™šæ‹Ÿæœº
          â””â”€ Ubuntu 22.04 å®¹å™¨
              â””â”€ ç¼–è¯‘ Agora SDK
```

Docker å®¹å™¨è¿è¡Œåœ¨ Linux ç¯å¢ƒä¸­ï¼Œæ‰€ä»¥éœ€è¦ Linux çš„ç¼–è¯‘å·¥å…·ã€‚

### ä¸‹è½½çš„åŒ…

| åŒ…å | ç”¨é€” | å¤§å° |
|------|------|------|
| build-essential | åŸºç¡€ç¼–è¯‘å·¥å…·ï¼ˆgcc, makeï¼‰ | ~50MB |
| cmake | æ„å»ºç³»ç»Ÿ | ~10MB |
| g++ | C++ ç¼–è¯‘å™¨ | ~30MB |

### é•œåƒæºå¯¹æ¯”

| æº | é€Ÿåº¦ | ç¨³å®šæ€§ |
|-----|------|--------|
| å®˜æ–¹æº | âŒ æ…¢/å¤±è´¥ | âŒ ä¸ç¨³å®š |
| é˜¿é‡Œäº‘ | âœ… å¿« | âœ… ç¨³å®š |
| æ¸…åå¤§å­¦ | âœ… å¿« | âœ… ç¨³å®š |

---

## ğŸ”§ å¦‚æœæ„å»ºå¤±è´¥

### æ£€æŸ¥é”™è¯¯æ—¥å¿—

æŸ¥çœ‹æ„å»ºè¾“å‡ºï¼Œæ‰¾åˆ°é”™è¯¯ä¿¡æ¯ã€‚

### å¤‡é€‰æ–¹æ¡ˆ

1. **ä½¿ç”¨æ¸…åå¤§å­¦é•œåƒ**ï¼š
   ```dockerfile
   RUN sed -i 's@//.*archive.ubuntu.com@//mirrors.tuna.tsinghua.edu.cn@g' /etc/apt/sources.list
   ```

2. **ä½¿ç”¨é™çº§æ¨¡å¼**ï¼š
   - ç»§ç»­ä½¿ç”¨å½“å‰ç³»ç»Ÿ
   - é…ç½®äº‘ç«¯å½•åˆ¶

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [Agora æœ¬åœ°å½•åˆ¶é›†æˆæŠ¥å‘Š](docs/features/Agoraæœ¬åœ°å½•åˆ¶é›†æˆå®ŒæˆæŠ¥å‘Š.md)
- [æœ¬åœ°å½•åˆ¶å¿«é€Ÿå¼€å§‹](docs/features/æœ¬åœ°å½•åˆ¶å¿«é€Ÿå¼€å§‹.md)
- [å½•åˆ¶åŠŸèƒ½å·²è§£å†³](docs/features/å½•åˆ¶åŠŸèƒ½å·²è§£å†³.md)

---

**æ„å»ºå¼€å§‹æ—¶é—´**ï¼š2026-02-09 10:35
**é¢„è®¡å®Œæˆæ—¶é—´**ï¼š2026-02-09 10:38-10:39
**çŠ¶æ€**ï¼šğŸ”„ æ„å»ºä¸­...
